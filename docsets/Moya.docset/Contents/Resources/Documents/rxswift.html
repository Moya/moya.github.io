<!DOCTYPE html>
<html lang="en">
  <head>
    <title>RxSwift  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
    
  </head>
  <body>
    <a title="RxSwift  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Moya Docs</a> (82% documented)</p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Moya Reference</a>
        <img id="carat" src="img/carat.png" />
        RxSwift  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
            <a href="Guides.html">Guides</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="authentication.html">Authentication</a>
              </li>
              <li class="nav-group-task">
                <a href="communityprojects.html">CommunityProjects</a>
              </li>
              <li class="nav-group-task">
                <a href="endpoints.html">Endpoints</a>
              </li>
              <li class="nav-group-task">
                <a href="plugins.html">Plugins</a>
              </li>
              <li class="nav-group-task">
                <a href="providers.html">Providers</a>
              </li>
              <li class="nav-group-task">
                <a href="readme.html">README</a>
              </li>
              <li class="nav-group-task">
                <a href="reactiveswift.html">ReactiveSwift</a>
              </li>
              <li class="nav-group-task">
                <a href="releasing.html">Releasing</a>
              </li>
              <li class="nav-group-task">
                <a href="rxswift.html">RxSwift</a>
              </li>
              <li class="nav-group-task">
                <a href="targets.html">Targets</a>
              </li>
              <li class="nav-group-task">
                <a href="testing.html">Testing</a>
              </li>
              <li class="nav-group-task">
                <a href="threading.html">Threading</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/CancellableToken.html">CancellableToken</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/CredentialsPlugin.html">CredentialsPlugin</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Endpoint.html">Endpoint</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/MoyaProvider.html">MoyaProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/NetworkActivityPlugin.html">NetworkActivityPlugin</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/NetworkLoggerPlugin.html">NetworkLoggerPlugin</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/NetworkLoggerPlugin/Configuration.html">– Configuration</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Response.html">Response</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Enums.html">Enumerations</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/AuthorizationType.html">AuthorizationType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/EndpointSampleResponse.html">EndpointSampleResponse</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MoyaError.html">MoyaError</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/MultiTarget.html">MultiTarget</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/NetworkActivityChangeType.html">NetworkActivityChangeType</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/StubBehavior.html">StubBehavior</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/Task.html">Task</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ValidationType.html">ValidationType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Extensions.html">Extensions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Extensions/Method.html">Method</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/Request.html">Request</a>
              </li>
              <li class="nav-group-task">
                <a href="Extensions/URL.html">URL</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Functions.html">Functions</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Functions.html#/s:4Moya23convertResponseToResult_7request4data5errors0E0OyAA0C0CAA0A5ErrorOGSo17NSHTTPURLResponseCSg_10Foundation10URLRequestVSgAP4DataVSgs0I0_pSgtF">convertResponseToResult(_:request:data:error:)</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols/AccessTokenAuthorizable.html">AccessTokenAuthorizable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Cancellable.html">Cancellable</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/MoyaProviderType.html">MoyaProviderType</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/PluginType.html">PluginType</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/RequestType.html">RequestType</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/TargetType.html">TargetType</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Structs.html">Structures</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/AccessTokenPlugin.html">AccessTokenPlugin</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MultipartFormData.html">MultipartFormData</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/MultipartFormData/FormDataProvider.html">– FormDataProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ProgressResponse.html">ProgressResponse</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
            <a href="Typealiases.html">Type Aliases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya10Completiona">Completion</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya19DownloadDestinationa">DownloadDestination</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya5Imagea">Image</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/ImageType">ImageType</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya9ImageTypea">ImageType</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya12JSONEncodinga">JSONEncoding</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya6Methoda">Method</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya17ParameterEncodinga">ParameterEncoding</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya13ProgressBlocka">ProgressBlock</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya18RequestInterceptora">RequestInterceptor</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya24RequestMultipartFormDataa">RequestMultipartFormData</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya7Sessiona">Session</a>
              </li>
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:4Moya11URLEncodinga">URLEncoding</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <h1 id='rxswift' class='heading'>RxSwift</h1>

<p>Moya provides an optional <code>RxSwift</code> implementation of
<code><a href="Classes/MoyaProvider.html">MoyaProvider</a></code> that does a few interesting things. Instead of
calling the <code>request()</code> method and providing a callback closure
to be executed when the request completes, we use <code>Observable</code>s.</p>

<p>To use reactive extensions you don&rsquo;t need any additional setup.
Just use your <code><a href="Classes/MoyaProvider.html">MoyaProvider</a></code> instance.</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">provider</span> <span class="o">=</span> <span class="kt">MoyaProvider</span><span class="o">&lt;</span><span class="kt">GitHub</span><span class="o">&gt;</span><span class="p">()</span>
</code></pre>

<p>After that simple setup, you&rsquo;re off to the races:</p>
<pre class="highlight swift"><code><span class="n">provider</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="nf">request</span><span class="p">(</span><span class="o">.</span><span class="n">zen</span><span class="p">)</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">event</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">event</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">success</span><span class="p">(</span><span class="k">let</span> <span class="nv">response</span><span class="p">):</span>
        <span class="c1">// do something with the data</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">error</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="c1">// handle the error</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>You can also use <code>requestWithProgress</code> to track progress of 
your request:</p>
<pre class="highlight swift"><code><span class="n">provider</span><span class="o">.</span><span class="n">rx</span><span class="o">.</span><span class="nf">requestWithProgress</span><span class="p">(</span><span class="o">.</span><span class="n">zen</span><span class="p">)</span><span class="o">.</span><span class="n">subscribe</span> <span class="p">{</span> <span class="n">event</span> <span class="k">in</span>
    <span class="k">switch</span> <span class="n">event</span> <span class="p">{</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">next</span><span class="p">(</span><span class="k">let</span> <span class="nv">progressResponse</span><span class="p">):</span>
        <span class="k">if</span> <span class="k">let</span> <span class="nv">response</span> <span class="o">=</span> <span class="n">progressResponse</span><span class="o">.</span><span class="n">response</span> <span class="p">{</span>
            <span class="c1">// do something with response</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nf">print</span><span class="p">(</span><span class="s">"Progress: </span><span class="se">\(</span><span class="n">progressResponse</span><span class="o">.</span><span class="n">progress</span><span class="se">)</span><span class="s">"</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="k">case</span> <span class="o">.</span><span class="nf">error</span><span class="p">(</span><span class="k">let</span> <span class="nv">error</span><span class="p">):</span>
        <span class="c1">// handle the error</span>
    <span class="k">default</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>It&rsquo;s important to remember that network request is not started
until the signal is subscribed to. If the subscription to the signal
is disposed of before the request completes, the request is canceled.</p>

<p>If the request completes normally, two things happen:</p>

<ol>
<li>The observable sends a value, a <code>Moya.Response</code> instance.</li>
<li>The observable completes.</li>
</ol>

<p>If the request produces an error (typically a <code>URLSession</code> error),
then it sends an error, instead. The error&rsquo;s <code>code</code> is the failing
request&rsquo;s status code, if any, and the response data, if any.</p>

<p>The <code>Moya.Response</code> class contains a <code>statusCode</code>, some <code>data</code>,
and a(n optional) <code>HTTPURLResponse</code>. You can use these values however
you like in <code>subscribe</code> or <code>map</code> calls.</p>

<p>To make things even awesomer, Moya provides some extensions to
<code>Single</code> and <code>Observable</code> that make dealing with <code>MoyaResponses</code>really easy.</p>

<ul>
<li><code>filter(statusCodes:)</code> takes a range of status codes. If the
response&rsquo;s status code is not within that range, an error is
produced.</li>
<li><code>filter(statusCode:)</code> looks for a specific status code, and errors
if it finds anything else.</li>
<li><code>filterSuccessfulStatusCodes()</code> filters status codes that
are in the 200-range.</li>
<li><code>filterSuccessfulStatusAndRedirectCodes()</code> filters status codes
that are in the 200-300 range.</li>
<li><code>mapImage()</code> tries to map the response data to a <code>UIImage</code> instance
and errors if unsuccessful.</li>
<li><code>mapJSON()</code> tries to map the response data to a JSON object and
errors if unsuccessful.</li>
<li><code>mapString()</code> tries to map the response data to a string and
errors if unsuccessful.</li>
<li><code>mapString(atKeyPath:)</code> tries to map a response data key path to a string and
errors if unsuccessful.</li>
</ul>

<p>In the error cases, the error&rsquo;s <code>domain</code> is <code>Moya.MoyaError</code>. The code
is one of <code>MoyaErrorCode</code>&lsquo;s <code>rawValue</code>s, where appropriate. Wherever
possible, underlying errors are provided and the original response
data is included in the <code>NSError</code>&rsquo;s <code>userInfo</code> dictionary using the
<q>data</q> key.</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2020 <a class="link" href="https://github.com/Moya/Moya" target="_blank" rel="external">Ash Furrow</a>. All rights reserved. (Last updated: 2020-02-24)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.9.6</a>, a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
